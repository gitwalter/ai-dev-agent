# User Story: US-E4-016 - Extract Real Agent Decisions from Workflow Outputs

**Epic**: EPIC-0 - Development Excellence
**Sprint**: Sprint 4  
**Priority**: Critical  
**Story Points**: 8  
**Status**: Backlog  

## Story Description

**As a** developer using the AI-Dev-Agent system  
**I want** real decisions made by each agent displayed in the UI  
**So that** I can understand what each agent actually decided and why  

## Root Cause Analysis

**Critical Issue Found**: Lines 600-614 in `apps/main.py` contain fake hardcoded decisions:
```python
decisions = result.get("decisions", [])
if not decisions:
    # Extract meaningful decisions based on agent type
    if agent_name == "requirements_analyst":
        decisions = ["Analyzed project requirements", "Identified key features", "Defined project scope"]
    elif agent_name == "code_generator":
        decisions = ["Selected programming patterns", "Implemented core functionality", "Applied best practices"]
```

These are completely fabricated! They don't reflect what the agents actually decided.

## Current Behavior (Broken)
- All agents show generic, hardcoded decisions
- Decisions are the same every time for the same agent type
- No connection to actual agent reasoning or workflow decisions
- Users get misleading information about agent behavior

## Expected Behavior (Fixed)
- Each agent displays its actual decisions from the workflow execution
- Decisions should be specific to the project and context
- Decision data should reflect real agent reasoning
- Different projects should show different decisions

## Acceptance Criteria

### Technical Requirements
- [ ] Remove all hardcoded decision defaults from lines 600-614
- [ ] Extract real decisions from agent workflow outputs
- [ ] Investigate agent output structure to find decision data
- [ ] Implement decision extraction logic for each agent type

### Data Investigation Requirements
- [ ] Examine what's actually in `result.get("decisions")` for each agent
- [ ] Check if decisions are stored in agent output metadata
- [ ] Look for decision traces in agent logs or reasoning chains
- [ ] Identify where agents record their decision-making process

### Testing Requirements
- [ ] Test with different project types to verify varying decisions
- [ ] Verify decisions are specific to project context
- [ ] Confirm UI displays meaningful decision information
- [ ] Test that complex projects show more sophisticated decisions

### Documentation Requirements
- [ ] Document the decision extraction logic
- [ ] Map agent decision-making patterns
- [ ] Create decision data architecture guide

## Definition of Done
- Real decisions extracted from agent workflow outputs
- UI displays authentic agent reasoning
- Decisions vary based on project context and complexity
- Zero hardcoded fake decisions in the codebase
- Agent decision-making is transparent and actionable

## Investigation Plan
1. **Workflow Output Analysis**: Examine agent output structure in detail
2. **Decision Source Mapping**: Find where agents store their decisions
3. **Extraction Logic**: Build real decision extraction from actual agent data
4. **Validation**: Ensure decisions reflect actual agent reasoning

## Technical Debt
Fake hardcoded decisions violate our core principle: "No defaults - they are lies." Every decision shown must reflect actual agent reasoning, not predetermined responses.
